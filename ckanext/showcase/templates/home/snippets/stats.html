{% set ckan_29_or_higher = h.ckan_version().split('.')[1] | int >= 9 %}
{% set showcase_index_route = 'showcase_blueprint.index' if ckan_29_or_higher else 'showcase_index' %}
{% set search_route = 'dataset.search' if ckan_29_or_higher else 'package_search' %}
{% set organization_route = 'organization.index' if ckan_29_or_higher else 'organization_index' %}
{% set group_route = 'group.index' if ckan_29_or_higher else 'group_index' %}

{% set stats = h.get_site_statistics() %}

<div class="box stats">
  <div class="inner">
    <h3>{{ _('{site_title} statistics').format(site_title=g.site_title) }}</h3>
    <ul>
      <li>
        <a href="{{ h.url_for(search_route) }}">
          <b>{{ h.SI_number_span(stats.dataset_count) }}</b>
          {{ ungettext('dataset', 'datasets', stats.dataset_count) }}
        </a>
      </li>
      <li>
        <a href="{{ h.url_for(organization_route) }}">
          <b>{{ h.SI_number_span(stats.organization_count) }}</b>
          {{ ungettext('organization', 'organizations', stats.organization_count) }}
        </a>
      </li>
      <li>
        <a href="{{ h.url_for(group_route) }}">
          <b>{{ h.SI_number_span(stats.group_count) }}</b>
          {{ ungettext('group', 'groups', stats.group_count) }}
        </a>
      </li>
      <li>
        <a href="{{ h.url_for(showcase_index_route) }}">
          <b>{{ h.SI_number_span(stats.showcase_count) }}</b>
          {{ ungettext('showcase', 'showcases', stats.showcase_count) }}
        </a>
      </li>
    </ul>
  </div>
</div>
